<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>SpringMVC源码分析 - wolai 笔记</title><link rel="shortcut icon" href="media/bxl-spring-boot_1.svg"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon icon-image" style="background-image: url(&quot;media/bxl-spring-boot.svg&quot;)"></div></div><div data-title="SpringMVC源码分析" class="main-title"></div></div></header><article><h3 class="wolai-block"><span class="inline-wrap">[_1_] 进入<span class="jill"></span>doDispatcher<span class="jill"></span>前</span></h3><h3 class="wolai-block"><span class="inline-wrap">[_2_] doDispatcher<span class="jill"></span>的执行流程</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">（1）调用<span class="jill"></span>mappedHandler = this.getHandler(processedRequest);  获取能够处理当前请求的执行链 HandlerExecutionChain （handler+<span class="jill"></span>拦截器）。</span></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">如何获取<span class="jill"></span>handler<span class="jill"></span>的？会遍历<span class="jill"></span>handlerMappings<span class="jill"></span>数组，对应的是不同的<span class="jill"></span>Mapper<span class="jill"></span>对象。</span></div></div><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="https://cdn.jsdelivr.net/gh/18476305640/typora@master/image/16518867643421651886763638.png" style="width: 720.6666666666666px"/></figure></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">（2）HandlerAdapter ha = this.getHandlerAdapter(mappedHandler.getHandler()); 从执行链中获取<span class="jill"></span>handler<span class="jill"></span>调用<span class="jill"></span>getHandlerAdapter<span class="jill"></span>方法获取 HandlerAdapter 。</span></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">如何获取的<span class="jill"></span>handlerAdapter？会遍历<span class="jill"></span>handlerAdapters<span class="jill"></span>数组，对应的是不同的<span class="jill"></span>adapter<span class="jill"></span>对象。</span></div></div><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="https://cdn.jsdelivr.net/gh/18476305640/typora@master/image/16518930253451651893025237.png" style="width: 715.3333333333334px"/></figure></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">（3）mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); 调用<span class="jill"></span>HandlerAdapter 的<span class="jill"></span>handle<span class="jill"></span>方法去执行那个<span class="jill"></span>handler<span class="jill"></span>得到<span class="jill"></span>ModelAndView。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">（4）this.processDispatchResult(processedRequest, response, mappedHandler, mv, (Exception)dispatchException); 调用<span class="jill"></span>processDispatchResult<span class="jill"></span>方法结合<span class="jill"></span>mv<span class="jill"></span>完成视图渲染与跳转。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h3 class="wolai-block"><span class="inline-wrap">[_3_] 九大组件 </span></h3><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre>    <span class="token comment">//多部件解析器</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">MultipartResolver</span> multipartResolver<span class="token punctuation">;</span>
    <span class="token comment">//国际化解析器</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">LocaleResolver</span> localeResolver<span class="token punctuation">;</span>
    <span class="token comment">//主题解析器</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">ThemeResolver</span> themeResolver<span class="token punctuation">;</span>
    <span class="token comment">//处理器映射器组件 </span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HandlerMapping</span><span class="token punctuation">></span></span> handlerMappings<span class="token punctuation">;</span>
    <span class="token comment">//处理器适配器组件 </span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HandlerAdapter</span><span class="token punctuation">></span></span> handlerAdapters<span class="token punctuation">;</span>
    <span class="token comment">//异常解析器组件</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HandlerExceptionResolver</span><span class="token punctuation">></span></span> handlerExceptionResolvers<span class="token punctuation">;</span>
    <span class="token comment">//默认视图名转换器组件 </span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">RequestToViewNameTranslator</span> viewNameTranslator<span class="token punctuation">;</span>
    <span class="token comment">//flash属性管理组件</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">FlashMapManager</span> flashMapManager<span class="token punctuation">;</span>
    <span class="token comment">//视图解析器</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ViewResolver</span><span class="token punctuation">></span></span> viewResolvers<span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h3 class="wolai-block"><span class="inline-wrap">[_4_] 组件的初始化</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">tomcat<span class="jill"></span>启动后，会有事件触发<span class="jill"></span>DisplayServlet<span class="jill"></span>调用<span class="jill"></span>onRefresh 方法，然后进行调用方法进行初始化。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></article><footer></footer></body></html>